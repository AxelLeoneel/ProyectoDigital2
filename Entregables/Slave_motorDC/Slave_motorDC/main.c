/*
 * Slave_motorDC.c
 *
 * Created: 15/08/2025 11:01:46
 * Author : gerav
 */ 

/********************************************************************/
/*--------------------- Header (Libraries)--------------------------*/
#define F_CPU 16000000
#include <avr/interrupt.h>
#include <avr/io.h>
#include <util/delay.h>
#include <stdlib.h>

#include "ADClib/ADClib.h"
#include "PWMlib/PWMlib.h"

/********************************************************************/



/********************************************************************/
/*-----------------------Function Prototypes------------------------*/
void setup();

/********************************************************************/



/********************************************************************/
/*-----------------------Variable Declaration-----------------------*/
volatile uint16_t adc_value = 0;

/********************************************************************/



/********************************************************************/
/*------------------------------Main--------------------------------*/
int main(void)
{
	setup();
	
	while (1)
	{
		ADCSRA |= (1 << ADSC);
		
		
		_delay_ms(50);
	}
}

/********************************************************************/



/********************************************************************/
/*---------------------Non-interrupt Subroutines--------------------*/
void setup(){
	cli();
	
	
	DDRD |= (1 << PORTD2);
	PORTD |= (1 << PORTD2);
	
	init_adc();
	init_pwm1(non_invert, 8);

	
	sei();
}

/********************************************************************/



/********************************************************************/
/*----------------------Interrupt Subroutines-----------------------*/
ISR(ADC_vect)
{
	adc_value = ADCH;
	
	uint16_t pwm_value = 10 + (adc_value * 2);
	
	DutyCycle1(pwm_value);
}

/********************************************************************/

